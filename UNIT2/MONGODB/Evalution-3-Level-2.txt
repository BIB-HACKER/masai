1. What is the total number of employees in all companies
=> db.companies.aggregate({$group:{totalempolyees:{$sum:"$number_of_emp"},_id:null}})

2. What is the average revenue across all companies
=> db.companies.aggregate({$group:{averagerevenue:{$avg:"$revenue_in_million"},_id:null}})

3. Which country has the highest number of companies listed?
=> db.companies.aggregate({$group:{totalcompanies:{$sum:1},_id:"$country"}},{$sort:{totalcompanies:-1}},{$limit:1})

4. Which city has the highest number of companies listed
=> db.companies.aggregate({$group:{totalcompanies:{$sum:1},_id:"$city"}},{$sort:{totalcompanies:-1}},{$limit:1})

5. What is the total revenue generated by companies in Sweden
=> db.companies.aggregate({$match:{country:"Sweden"}},{$group:{totalrevenue:{$sum:"$revenue_in_million"},_id:null}})

6. How many companies operate in the Healthcare industry
=> db.companies.count({industry:"Healthcare"})

7. What is the average revenue for companies in the Renewable Energy industry?
=> db.companies.aggregate({$match:{industry:"Renewable Energy"}},{$group:{averagerevenue:{$avg:"$revenue_in_million"},_id:null}})

8. What is the average revenue for companies in each country
=> db.companies.aggregate({$group:{averagerevenue:{$avg:"$revenue_in_million"},_id:"$country"}})

9. How many companies operate in each city
=> db.companies.aggregate({$group:{totalcompanies:{$sum:1},_id:"$city"}})

10. Which country has the highest average revenue per company
=> db.companies.aggregate({$group:{AverageRevenuePerCompany:{$avg:"$revenue_in_million"},_id:"$country"}},{$sort:{AverageRevenuePerCompany:-1}},{$limit:1})

11. Which city has the highest average revenue per company
=> db.companies.aggregate({$group:{AverageRevenuePerCompany:{$avg:"$revenue_in_million"},_id:"$city"}},{$sort:{AverageRevenuePerCompany:-1}},{$limit:1})

12. Which country has the highest total revenue generated by companies
=> db.companies.aggregate({$group:{totalrevenue:{$sum:"$revenue_in_million"},_id:"$country"}},{$sort:{totalrevenue:-1}},{$limit:1})

13. What is the average revenue for companies in each city
=> db.companies.aggregate({$group:{averagerevenue:{$avg:"$revenue_in_million"},_id:"$city"}})

14. What is the average number of industries represented per company?
=> db.companies.aggregate({$group:{averageindustries:{$avg:{$size:"$industry"}},_id:null}})

15. How many companies operate in each country in Europe. A company is from europe if it is from one of these below countries:- Sweden, Germany, France, Spain, Italy, United Kingdom
=> db.companies.aggregate({$match:{country:{$in:["Sweden","Germany","Spain","Italy","United Kingdom"]}}},{$group:{totalcompanies:{$sum:1},_id:"$country"}})

16. What is the total revenue generated by companies in the Education and Healthcare industries
=> db.companies.aggregate({$match:{industry:{$in:["Education","Healthcare"]}}},{$group:{totalrevenue:{$sum:"$revenue_in_million"},_id:null}})

17. How many companies operate in each city in Germany
=> db.companies.aggregate([{$match:{"address.country":"Germany"}},{$group:{count:{$sum:1},_id:"$city"}}])

18. Which country has the highest total number of employees across all companies.
=> db.companies.aggregate([{$group:{totalemployees:{$sum:"$number_of_emp"},_id:"$country"}},{$sort:{totalemployees:-1}},{$limit:1}])